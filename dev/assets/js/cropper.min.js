/*!
 * =====================================================
 * zanfuwu by yangbinbin - http://m.zanfuwu.com/
 *
 * =====================================================
 */
!function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("Cropper requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(a,b){"use strict";function c(a){return gb.call(a).slice(8,-1).toLowerCase()}function d(a){return"number"==typeof a&&!isNaN(a)}function e(a){return"undefined"==typeof a}function f(a){return"object"==typeof a&&null!==a}function g(a){var b,c;if(!f(a))return!1;try{return b=a.constructor,c=b.prototype,b&&c&&hb.call(c,"isPrototypeOf")}catch(d){return!1}}function h(a){return"function"===c(a)}function i(a){return Z.isArray?Z.isArray(a):"array"===c(a)}function j(a,b){return b=b>=0?b:0,Z.from?Z.from(a).slice(b):ib.call(a,b)}function k(a){return"string"==typeof a&&(a=a.trim?a.trim():a.replace(Ca,"$1")),a}function l(a,b){var c,e;if(a&&h(b))if(i(a)||d(a.length))for(e=0,c=a.length;e<c&&b.call(a,a[e],e,a)!==!1;e++);else if(f(a))for(e in a)if(a.hasOwnProperty(e)&&b.call(a,a[e],e,a)===!1)break;return a}function m(a){var b;if(arguments.length>1){if(b=j(arguments),Y.assign)return Y.assign.apply(Y,b);b.shift(),l(b,function(b){l(b,function(b,c){a[c]=b})})}return a}function n(a,b){var c=j(arguments,2);return function(){return a.apply(b,c.concat(j(arguments)))}}function o(a,b){var c=a.style;l(b,function(a,b){Aa.test(b)&&d(a)&&(a+="px"),c[b]=a})}function p(a,b){return a.classList?a.classList.contains(b):a.className.indexOf(b)>-1}function q(a,b){var c;return d(a.length)?l(a,function(a){q(a,b)}):a.classList?a.classList.add(b):(c=k(a.className),void(c?c.indexOf(b)<0&&(a.className=c+" "+b):a.className=b))}function r(a,b){return d(a.length)?l(a,function(a){r(a,b)}):a.classList?a.classList.remove(b):void(a.className.indexOf(b)>=0&&(a.className=a.className.replace(b,"")))}function s(a,b,c){return d(a.length)?l(a,function(a){s(a,b,c)}):void(c?q(a,b):r(a,b))}function t(a,b){return f(a[b])?a[b]:a.dataset?a.dataset[b]:a.getAttribute("data-"+b)}function u(a,b,c){f(c)&&e(a[b])?a[b]=c:a.dataset?a.dataset[b]=c:a.setAttribute("data-"+b,c)}function v(a,b){f(a[b])?delete a[b]:a.dataset?delete a.dataset[b]:a.removeAttribute("data-"+b)}function w(a,b,c,d){var e=k(b).split(Da),f=c;return e.length>1?l(e,function(b){w(a,b,c)}):(d&&(c=function(){return x(a,b,c),f.apply(a,arguments)}),void(a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent&&a.attachEvent("on"+b,c)))}function x(a,b,c){var d=k(b).split(Da);return d.length>1?l(d,function(b){x(a,b,c)}):void(a.removeEventListener?a.removeEventListener(b,c,!1):a.detachEvent&&a.detachEvent("on"+b,c))}function y(a,b,c){var d;return a.dispatchEvent?(h(Event)&&h(CustomEvent)?d=e(c)?new Event(b,{bubbles:!0,cancelable:!0}):new CustomEvent(b,{detail:c,bubbles:!0,cancelable:!0}):e(c)?(d=U.createEvent("Event"),d.initEvent(b,!0,!0)):(d=U.createEvent("CustomEvent"),d.initCustomEvent(b,!0,!0,c)),a.dispatchEvent(d)):a.fireEvent?a.fireEvent("on"+b):void 0}function z(a){a.preventDefault?a.preventDefault():a.returnValue=!1}function A(b){var c,e=b||a.event;return e.target||(e.target=e.srcElement||U),d(e.pageX)||(c=U.documentElement,e.pageX=e.clientX+(a.scrollX||c&&c.scrollLeft||0)-(c&&c.clientLeft||0),e.pageY=e.clientY+(a.scrollY||c&&c.scrollTop||0)-(c&&c.clientTop||0)),e}function B(b){var c=U.documentElement,d=b.getBoundingClientRect();return{left:d.left+(a.scrollX||c&&c.scrollLeft||0)-(c&&c.clientLeft||0),top:d.top+(a.scrollY||c&&c.scrollTop||0)-(c&&c.clientTop||0)}}function C(a){var b=a.length,c=0,d=0;return b&&(l(a,function(a){c+=a.pageX,d+=a.pageY}),c/=b,d/=b),{pageX:c,pageY:d}}function D(a,b){return a.getElementsByTagName(b)}function E(a,b){return a.getElementsByClassName?a.getElementsByClassName(b):a.querySelectorAll("."+b)}function F(a){return U.createElement(a)}function G(a,b){a.appendChild(b)}function H(a){a.parentNode&&a.parentNode.removeChild(a)}function I(a){for(;a.firstChild;)a.removeChild(a.firstChild)}function J(a){var b=a.match(Ba);return b&&(b[1]!==V.protocol||b[2]!==V.hostname||b[3]!==V.port)}function K(a){var b="timestamp="+(new Date).getTime();return a+(a.indexOf("?")===-1?"?":"&")+b}function L(a,b){var c;return a.naturalWidth&&!Xa?b(a.naturalWidth,a.naturalHeight):(c=F("img"),c.onload=function(){b(this.width,this.height)},void(c.src=a.src))}function M(a){var b=[],c=a.rotate,e=a.scaleX,f=a.scaleY;return d(c)&&b.push("rotate("+c+"deg)"),d(e)&&d(f)&&b.push("scale("+e+","+f+")"),b.length?b.join(" "):"none"}function N(a,b){var c,d,e=$a(a.degree)%180,f=(e>90?180-e:e)*eb/180,g=_a(f),h=ab(f),i=a.width,j=a.height,k=a.aspectRatio;return b?(c=i/(h+g/k),d=c/k):(c=i*h+j*g,d=i*g+j*h),{width:c,height:d}}function O(a,b){var c,e,f,g=F("canvas"),h=g.getContext("2d"),i=0,j=0,k=b.naturalWidth,l=b.naturalHeight,m=b.rotate,n=b.scaleX,o=b.scaleY,p=d(n)&&d(o)&&(1!==n||1!==o),q=d(m)&&0!==m,r=q||p,s=k*$a(n||1),t=l*$a(o||1);return p&&(c=s/2,e=t/2),q&&(f=N({width:s,height:t,degree:m}),s=f.width,t=f.height,c=s/2,e=t/2),g.width=s,g.height=t,r&&(i=-k/2,j=-l/2,h.save(),h.translate(c,e)),q&&h.rotate(m*eb/180),p&&h.scale(n,o),h.drawImage(a,db(i),db(j),db(k),db(l)),r&&h.restore(),g}function P(a,b,c){var d="",e=b;for(c+=b;e<c;e++)d+=jb(a.getUint8(e));return d}function Q(a){var b,c,d,e,f,g,h,i,j,k,l=new DataView(a),m=l.byteLength;if(255===l.getUint8(0)&&216===l.getUint8(1))for(j=2;j<m;){if(255===l.getUint8(j)&&225===l.getUint8(j+1)){h=j;break}j++}if(h&&(c=h+4,d=h+10,"Exif"===P(l,c,4)&&(g=l.getUint16(d),f=18761===g,(f||19789===g)&&42===l.getUint16(d+2,f)&&(e=l.getUint32(d+4,f),e>=8&&(i=d+e)))),i)for(m=l.getUint16(i,f),k=0;k<m;k++)if(j=i+12*k+2,274===l.getUint16(j,f)){j+=8,b=l.getUint16(j,f),Xa&&l.setUint16(j,1,f);break}return b}function R(a){var b,c=a.replace(Fa,""),d=atob(c),e=d.length,f=new X(e),g=new Uint8Array(f);for(b=0;b<e;b++)g[b]=d.charCodeAt(b);return f}function S(a){var b,c=new Uint8Array(a),d=c.length,e="";for(b=0;b<d;b++)e+=jb(c[b]);return"data:image/jpeg;base64,"+btoa(e)}function T(a,b){var c=this;c.element=a,c.options=m({},T.DEFAULTS,g(b)&&b),c.ready=!1,c.built=!1,c.complete=!1,c.rotated=!1,c.cropped=!1,c.disabled=!1,c.replaced=!1,c.limited=!1,c.wheeling=!1,c.isImg=!1,c.originalUrl="",c.canvasData=null,c.cropBoxData=null,c.previews=null,c.init()}var U=a.document,V=a.location,W=a.navigator,X=a.ArrayBuffer,Y=a.Object,Z=a.Array,$=a.String,_=a.Number,aa=a.Math,ba="cropper",ca=ba+"-modal",da=ba+"-hide",ea=ba+"-hidden",fa=ba+"-invisible",ga=ba+"-move",ha=ba+"-crop",ia=ba+"-disabled",ja=ba+"-bg",ka="mousedown touchstart pointerdown MSPointerDown",la="mousemove touchmove pointermove MSPointerMove",ma="mouseup touchend touchcancel pointerup pointercancel MSPointerUp MSPointerCancel",na="wheel mousewheel DOMMouseScroll",oa="dblclick",pa="resize",qa="error",ra="load",sa="build",ta="built",ua="cropstart",va="cropmove",wa="cropend",xa="crop",ya="zoom",za=/e|w|s|n|se|sw|ne|nw|all|crop|move|zoom/,Aa=/width|height|left|top|marginLeft|marginTop/,Ba=/^(https?:)\/\/([^\:\/\?#]+):?(\d*)/i,Ca=/^\s+(.*)\s+$/,Da=/\s+/,Ea=/^data\:/,Fa=/^data\:([^\;]+)\;base64,/,Ga=/^data\:image\/jpeg.*;base64,/,Ha="preview",Ia="action",Ja="e",Ka="w",La="s",Ma="n",Na="se",Oa="sw",Pa="ne",Qa="nw",Ra="all",Sa="crop",Ta="move",Ua="zoom",Va="none",Wa=!!U.createElement("canvas").getContext,Xa=W&&/safari/i.test(W.userAgent)&&/apple computer/i.test(W.vendor),Ya=aa.min,Za=aa.max,$a=aa.abs,_a=aa.sin,ab=aa.cos,bb=aa.sqrt,cb=aa.round,db=aa.floor,eb=aa.PI,fb=Y.prototype,gb=fb.toString,hb=fb.hasOwnProperty,ib=Z.prototype.slice,jb=$.fromCharCode;T.prototype={constructor:T,init:function(){var a,b=this,c=b.element,d=c.tagName.toLowerCase();if(!t(c,ba)){if(u(c,ba,b),"img"===d){if(b.isImg=!0,b.originalUrl=a=c.getAttribute("src"),!a)return;a=c.src}else"canvas"===d&&Wa&&(a=c.toDataURL());b.load(a)}},load:function(a){var b,c=this,d=c.options,e=c.element;if(a&&(h(d.build)&&w(e,sa,d.build,!0),y(e,sa)!==!1)){if(c.url=a,c.imageData={},!d.checkOrientation||!X)return c.clone();if(Ea.test(a))return Ga.test(a)?c.read(R(a)):c.clone();b=new XMLHttpRequest,b.onerror=b.onabort=function(){c.clone()},b.onload=function(){c.read(this.response)},b.open("get",a),b.responseType="arraybuffer",b.send()}},read:function(a){var b,c,d,e=this,f=e.options,g=Q(a),h=e.imageData;if(g>1)switch(e.url=S(a),g){case 2:c=-1;break;case 3:b=-180;break;case 4:d=-1;break;case 5:b=90,d=-1;break;case 6:b=90;break;case 7:b=90,c=-1;break;case 8:b=-90}f.rotatable&&(h.rotate=b),f.scalable&&(h.scaleX=c,h.scaleY=d),e.clone()},clone:function(){var a,b,c,d,e,f=this,g=f.element,h=f.url;f.options.checkCrossOrigin&&J(h)&&(a=g.crossOrigin,a?b=h:(a="anonymous",b=K(h))),f.crossOrigin=a,f.crossOriginUrl=b,c=F("img"),a&&(c.crossOrigin=a),c.src=b||h,f.image=c,f._start=d=n(f.start,f),f._stop=e=n(f.stop,f),f.isImg?g.complete?f.start():w(g,ra,d):(w(c,ra,d),w(c,qa,e),q(c,da),g.parentNode.insertBefore(c,g.nextSibling))},start:function(a){var b=this,c=b.isImg?b.element:b.image;a&&(x(c,ra,b._start),x(c,qa,b._stop)),L(c,function(a,c){m(b.imageData,{naturalWidth:a,naturalHeight:c,aspectRatio:a/c}),b.ready=!0,b.build()})},stop:function(){var a=this,b=a.image;x(b,ra,a._start),x(b,qa,a._stop),H(b),a.image=null},build:function(){var a,b,c,d,e,f,g,i=this,j=i.options,k=i.element,l=i.image;i.ready&&(i.built&&i.unbuild(),b=F("div"),b.innerHTML=T.TEMPLATE,i.container=a=k.parentNode,i.cropper=c=E(b,"cropper-container")[0],i.canvas=d=E(c,"cropper-canvas")[0],i.dragBox=e=E(c,"cropper-drag-box")[0],i.cropBox=f=E(c,"cropper-crop-box")[0],i.viewBox=E(c,"cropper-view-box")[0],i.face=g=E(f,"cropper-face")[0],G(d,l),q(k,ea),a.insertBefore(c,k.nextSibling),i.isImg||r(l,da),i.initPreview(),i.bind(),j.aspectRatio=Za(0,j.aspectRatio)||NaN,j.viewMode=Za(0,Ya(3,cb(j.viewMode)))||0,j.autoCrop?(i.cropped=!0,j.modal&&q(e,ca)):q(f,ea),j.guides||q(E(f,"cropper-dashed"),ea),j.center||q(E(f,"cropper-center"),ea),j.background&&q(c,ja),j.highlight||q(g,fa),j.cropBoxMovable&&(q(g,ga),u(g,Ia,Ra)),j.cropBoxResizable||(q(E(f,"cropper-line"),ea),q(E(f,"cropper-point"),ea)),i.setDragMode(j.dragMode),i.render(),i.built=!0,i.setData(j.data),setTimeout(function(){h(j.built)&&w(k,ta,j.built,!0),y(k,ta),y(k,xa,i.getData()),i.complete=!0},0))},unbuild:function(){var a=this;a.built&&(a.built=!1,a.complete=!1,a.initialImageData=null,a.initialCanvasData=null,a.initialCropBoxData=null,a.containerData=null,a.canvasData=null,a.cropBoxData=null,a.unbind(),a.resetPreview(),a.previews=null,a.viewBox=null,a.cropBox=null,a.dragBox=null,a.canvas=null,a.container=null,H(a.cropper),a.cropper=null)},render:function(){var a=this;a.initContainer(),a.initCanvas(),a.initCropBox(),a.renderCanvas(),a.cropped&&a.renderCropBox()},initContainer:function(){var a,b=this,c=b.options,d=b.element,e=b.container,f=b.cropper;q(f,ea),r(d,ea),b.containerData=a={width:Za(e.offsetWidth,_(c.minContainerWidth)||200),height:Za(e.offsetHeight,_(c.minContainerHeight)||100)},o(f,{width:a.width,height:a.height}),q(d,ea),r(f,ea)},initCanvas:function(){var a,b=this,c=b.options.viewMode,d=b.containerData,e=b.imageData,f=90===$a(e.rotate),g=f?e.naturalHeight:e.naturalWidth,h=f?e.naturalWidth:e.naturalHeight,i=g/h,j=d.width,k=d.height;d.height*i>d.width?3===c?j=d.height*i:k=d.width/i:3===c?k=d.width/i:j=d.height*i,a={naturalWidth:g,naturalHeight:h,aspectRatio:i,width:j,height:k},a.oldLeft=a.left=(d.width-j)/2,a.oldTop=a.top=(d.height-k)/2,b.canvasData=a,b.limited=1===c||2===c,b.limitCanvas(!0,!0),b.initialImageData=m({},e),b.initialCanvasData=m({},a)},limitCanvas:function(a,b){var c,d,e,f,g=this,h=g.options,i=h.viewMode,j=g.containerData,k=g.canvasData,l=k.aspectRatio,m=g.cropBoxData,n=g.cropped&&m;a&&(c=_(h.minCanvasWidth)||0,d=_(h.minCanvasHeight)||0,i>1?(c=Za(c,j.width),d=Za(d,j.height),3===i&&(d*l>c?c=d*l:d=c/l)):i>0&&(c?c=Za(c,n?m.width:0):d?d=Za(d,n?m.height:0):n&&(c=m.width,d=m.height,d*l>c?c=d*l:d=c/l)),c&&d?d*l>c?d=c/l:c=d*l:c?d=c/l:d&&(c=d*l),k.minWidth=c,k.minHeight=d,k.maxWidth=1/0,k.maxHeight=1/0),b&&(i?(e=j.width-k.width,f=j.height-k.height,k.minLeft=Ya(0,e),k.minTop=Ya(0,f),k.maxLeft=Za(0,e),k.maxTop=Za(0,f),n&&g.limited&&(k.minLeft=Ya(m.left,m.left+m.width-k.width),k.minTop=Ya(m.top,m.top+m.height-k.height),k.maxLeft=m.left,k.maxTop=m.top,2===i&&(k.width>=j.width&&(k.minLeft=Ya(0,e),k.maxLeft=Za(0,e)),k.height>=j.height&&(k.minTop=Ya(0,f),k.maxTop=Za(0,f))))):(k.minLeft=-k.width,k.minTop=-k.height,k.maxLeft=j.width,k.maxTop=j.height))},renderCanvas:function(a){var b,c,d=this,e=d.canvasData,f=d.imageData,g=f.rotate;d.rotated&&(d.rotated=!1,c=N({width:f.width,height:f.height,degree:g}),b=c.width/c.height,b!==e.aspectRatio&&(e.left-=(c.width-e.width)/2,e.top-=(c.height-e.height)/2,e.width=c.width,e.height=c.height,e.aspectRatio=b,e.naturalWidth=f.naturalWidth,e.naturalHeight=f.naturalHeight,g%180&&(c=N({width:f.naturalWidth,height:f.naturalHeight,degree:g}),e.naturalWidth=c.width,e.naturalHeight=c.height),d.limitCanvas(!0,!1))),(e.width>e.maxWidth||e.width<e.minWidth)&&(e.left=e.oldLeft),(e.height>e.maxHeight||e.height<e.minHeight)&&(e.top=e.oldTop),e.width=Ya(Za(e.width,e.minWidth),e.maxWidth),e.height=Ya(Za(e.height,e.minHeight),e.maxHeight),d.limitCanvas(!1,!0),e.oldLeft=e.left=Ya(Za(e.left,e.minLeft),e.maxLeft),e.oldTop=e.top=Ya(Za(e.top,e.minTop),e.maxTop),o(d.canvas,{width:e.width,height:e.height,left:e.left,top:e.top}),d.renderImage(),d.cropped&&d.limited&&d.limitCropBox(!0,!0),a&&d.output()},renderImage:function(a){var b,c,d,e,f,g=this,h=g.canvasData,i=g.imageData;i.rotate&&(c=N({width:h.width,height:h.height,degree:i.rotate,aspectRatio:i.aspectRatio},!0),d=c.width,e=c.height,b={width:d,height:e,left:(h.width-d)/2,top:(h.height-e)/2}),m(i,b||{width:h.width,height:h.height,left:0,top:0}),f=M(i),o(g.image,{width:i.width,height:i.height,marginLeft:i.left,marginTop:i.top,WebkitTransform:f,msTransform:f,transform:f}),a&&g.output()},initCropBox:function(){var a=this,b=a.options,c=b.aspectRatio,d=_(b.autoCropArea)||.8,e=a.canvasData,f={width:e.width,height:e.height};c&&(e.height*c>e.width?f.height=f.width/c:f.width=f.height*c),a.cropBoxData=f,a.limitCropBox(!0,!0),f.width=Ya(Za(f.width,f.minWidth),f.maxWidth),f.height=Ya(Za(f.height,f.minHeight),f.maxHeight),f.width=Za(f.minWidth,f.width*d),f.height=Za(f.minHeight,f.height*d),f.oldLeft=f.left=e.left+(e.width-f.width)/2,f.oldTop=f.top=e.top+(e.height-f.height)/2,a.initialCropBoxData=m({},f)},limitCropBox:function(a,b){var c,d,e,f,g=this,h=g.options,i=h.aspectRatio,j=g.containerData,k=g.canvasData,l=g.cropBoxData,m=g.limited;a&&(c=_(h.minCropBoxWidth)||0,d=_(h.minCropBoxHeight)||0,c=Ya(c,j.width),d=Ya(d,j.height),e=Ya(j.width,m?k.width:j.width),f=Ya(j.height,m?k.height:j.height),i&&(c&&d?d*i>c?d=c/i:c=d*i:c?d=c/i:d&&(c=d*i),f*i>e?f=e/i:e=f*i),l.minWidth=Ya(c,e),l.minHeight=Ya(d,f),l.maxWidth=e,l.maxHeight=f),b&&(m?(l.minLeft=Za(0,k.left),l.minTop=Za(0,k.top),l.maxLeft=Ya(j.width,k.left+k.width)-l.width,l.maxTop=Ya(j.height,k.top+k.height)-l.height):(l.minLeft=0,l.minTop=0,l.maxLeft=j.width-l.width,l.maxTop=j.height-l.height))},renderCropBox:function(){var a=this,b=a.options,c=a.containerData,d=a.cropBoxData;(d.width>d.maxWidth||d.width<d.minWidth)&&(d.left=d.oldLeft),(d.height>d.maxHeight||d.height<d.minHeight)&&(d.top=d.oldTop),d.width=Ya(Za(d.width,d.minWidth),d.maxWidth),d.height=Ya(Za(d.height,d.minHeight),d.maxHeight),a.limitCropBox(!1,!0),d.oldLeft=d.left=Ya(Za(d.left,d.minLeft),d.maxLeft),d.oldTop=d.top=Ya(Za(d.top,d.minTop),d.maxTop),b.movable&&b.cropBoxMovable&&u(a.face,Ia,d.width===c.width&&d.height===c.height?Ta:Ra),o(a.cropBox,{width:d.width,height:d.height,left:d.left,top:d.top}),a.cropped&&a.limited&&a.limitCanvas(!0,!0),a.disabled||a.output()},output:function(){var a=this;a.preview(),a.complete&&y(a.element,xa,a.getData())},initPreview:function(){var a,b=this,c=b.options.preview,d=F("img"),e=b.crossOrigin,f=e?b.crossOriginUrl:b.url;e&&(d.crossOrigin=e),d.src=f,G(b.viewBox,d),b.image2=d,c&&(b.previews=a=U.querySelectorAll(c),l(a,function(a){var b=F("img");u(a,Ha,{width:a.offsetWidth,height:a.offsetHeight,html:a.innerHTML}),e&&(b.crossOrigin=e),b.src=f,b.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"',I(a),G(a,b)}))},resetPreview:function(){l(this.previews,function(a){var b=t(a,Ha);o(a,{width:b.width,height:b.height}),a.innerHTML=b.html,v(a,Ha)})},preview:function(){var a=this,b=a.imageData,c=a.canvasData,d=a.cropBoxData,e=d.width,f=d.height,g=b.width,h=b.height,i=d.left-c.left-b.left,j=d.top-c.top-b.top,k=M(b),n={WebkitTransform:k,msTransform:k,transform:k};a.cropped&&!a.disabled&&(o(a.image2,m({width:g,height:h,marginLeft:-i,marginTop:-j},n)),l(a.previews,function(a){var b=t(a,Ha),c=b.width,d=b.height,k=c,l=d,p=1;e&&(p=c/e,l=f*p),f&&l>d&&(p=d/f,k=e*p,l=d),o(a,{width:k,height:l}),o(D(a,"img")[0],m({width:g*p,height:h*p,marginLeft:-i*p,marginTop:-j*p},n))}))},bind:function(){var b=this,c=b.options,d=b.element,e=b.cropper;h(c.cropstart)&&w(d,ua,c.cropstart),h(c.cropmove)&&w(d,va,c.cropmove),h(c.cropend)&&w(d,wa,c.cropend),h(c.crop)&&w(d,xa,c.crop),h(c.zoom)&&w(d,ya,c.zoom),w(e,ka,b._cropStart=n(b.cropStart,b)),c.zoomable&&c.zoomOnWheel&&w(e,na,b._wheel=n(b.wheel,b)),c.toggleDragModeOnDblclick&&w(e,oa,b._dblclick=n(b.dblclick,b)),w(U,la,b._cropMove=n(b.cropMove,b)),w(U,ma,b._cropEnd=n(b.cropEnd,b)),c.responsive&&w(a,pa,b._resize=n(b.resize,b))},unbind:function(){var b=this,c=b.options,d=b.element,e=b.cropper;h(c.cropstart)&&x(d,ua,c.cropstart),h(c.cropmove)&&x(d,va,c.cropmove),h(c.cropend)&&x(d,wa,c.cropend),h(c.crop)&&x(d,xa,c.crop),h(c.zoom)&&x(d,ya,c.zoom),x(e,ka,b._cropStart),c.zoomable&&c.zoomOnWheel&&x(e,na,b._wheel),c.toggleDragModeOnDblclick&&x(e,oa,b._dblclick),x(U,la,b._cropMove),x(U,ma,b._cropEnd),c.responsive&&x(a,pa,b._resize)},resize:function(){var a,b,c,d=this,e=d.options.restore,f=d.container,g=d.containerData;!d.disabled&&g&&(c=f.offsetWidth/g.width,1===c&&f.offsetHeight===g.height||(e&&(a=d.getCanvasData(),b=d.getCropBoxData()),d.render(),e&&(d.setCanvasData(l(a,function(b,d){a[d]=b*c})),d.setCropBoxData(l(b,function(a,d){b[d]=a*c})))))},dblclick:function(){var a=this;a.disabled||a.setDragMode(p(a.dragBox,ha)?Ta:Sa)},wheel:function(a){var b=this,c=A(a),d=_(b.options.wheelZoomRatio)||.1,e=1;b.disabled||(z(c),b.wheeling||(b.wheeling=!0,setTimeout(function(){b.wheeling=!1},50),c.deltaY?e=c.deltaY>0?1:-1:c.wheelDelta?e=-c.wheelDelta/120:c.detail&&(e=c.detail>0?1:-1),b.zoom(-e*d,c)))},cropStart:function(a){var b,c,d,e=this,f=e.options,g=A(a),h=g.touches;if(!e.disabled){if(h){if(b=h.length,b>1){if(!f.zoomable||!f.zoomOnTouch||2!==b)return;c=h[1],e.startX2=c.pageX,e.startY2=c.pageY,d=Ua}c=h[0]}if(d=d||t(g.target,Ia),za.test(d)){if(y(e.element,ua,{originalEvent:g,action:d})===!1)return;z(g),e.action=d,e.cropping=!1,e.startX=c?c.pageX:g.pageX,e.startY=c?c.pageY:g.pageY,d===Sa&&(e.cropping=!0,q(e.dragBox,ca))}}},cropMove:function(a){var b,c,d=this,e=d.options,f=A(a),g=f.touches,h=d.action;if(!d.disabled){if(g){if(b=g.length,b>1){if(!e.zoomable||!e.zoomOnTouch||2!==b)return;c=g[1],d.endX2=c.pageX,d.endY2=c.pageY}c=g[0]}if(h){if(y(d.element,va,{originalEvent:f,action:h})===!1)return;z(f),d.endX=c?c.pageX:f.pageX,d.endY=c?c.pageY:f.pageY,d.change(f.shiftKey,h===Ua?f:null)}}},cropEnd:function(a){var b=this,c=b.options,d=A(a),e=b.action;b.disabled||e&&(z(d),b.cropping&&(b.cropping=!1,s(b.dragBox,ca,b.cropped&&c.modal)),b.action="",y(b.element,wa,{originalEvent:d,action:e}))},change:function(a,b){var c,d,e=this,f=e.options,g=f.aspectRatio,h=e.action,i=e.containerData,j=e.canvasData,k=e.cropBoxData,l=k.width,m=k.height,n=k.left,o=k.top,p=n+l,q=o+m,s=0,t=0,u=i.width,v=i.height,w=!0;switch(!g&&a&&(g=l&&m?l/m:1),e.limited&&(s=k.minLeft,t=k.minTop,u=s+Ya(i.width,j.left+j.width),v=t+Ya(i.height,j.top+j.height)),d={x:e.endX-e.startX,y:e.endY-e.startY},g&&(d.X=d.y*g,d.Y=d.x/g),h){case Ra:n+=d.x,o+=d.y;break;case Ja:if(d.x>=0&&(p>=u||g&&(o<=t||q>=v))){w=!1;break}l+=d.x,g&&(m=l/g,o-=d.Y/2),l<0&&(h=Ka,l=0);break;case Ma:if(d.y<=0&&(o<=t||g&&(n<=s||p>=u))){w=!1;break}m-=d.y,o+=d.y,g&&(l=m*g,n+=d.X/2),m<0&&(h=La,m=0);break;case Ka:if(d.x<=0&&(n<=s||g&&(o<=t||q>=v))){w=!1;break}l-=d.x,n+=d.x,g&&(m=l/g,o+=d.Y/2),l<0&&(h=Ja,l=0);break;case La:if(d.y>=0&&(q>=v||g&&(n<=s||p>=u))){w=!1;break}m+=d.y,g&&(l=m*g,n-=d.X/2),m<0&&(h=Ma,m=0);break;case Pa:if(g){if(d.y<=0&&(o<=t||p>=u)){w=!1;break}m-=d.y,o+=d.y,l=m*g}else d.x>=0?p<u?l+=d.x:d.y<=0&&o<=t&&(w=!1):l+=d.x,d.y<=0?o>t&&(m-=d.y,o+=d.y):(m-=d.y,o+=d.y);l<0&&m<0?(h=Oa,m=0,l=0):l<0?(h=Qa,l=0):m<0&&(h=Na,m=0);break;case Qa:if(g){if(d.y<=0&&(o<=t||n<=s)){w=!1;break}m-=d.y,o+=d.y,l=m*g,n+=d.X}else d.x<=0?n>s?(l-=d.x,n+=d.x):d.y<=0&&o<=t&&(w=!1):(l-=d.x,n+=d.x),d.y<=0?o>t&&(m-=d.y,o+=d.y):(m-=d.y,o+=d.y);l<0&&m<0?(h=Na,m=0,l=0):l<0?(h=Pa,l=0):m<0&&(h=Oa,m=0);break;case Oa:if(g){if(d.x<=0&&(n<=s||q>=v)){w=!1;break}l-=d.x,n+=d.x,m=l/g}else d.x<=0?n>s?(l-=d.x,n+=d.x):d.y>=0&&q>=v&&(w=!1):(l-=d.x,n+=d.x),d.y>=0?q<v&&(m+=d.y):m+=d.y;l<0&&m<0?(h=Pa,m=0,l=0):l<0?(h=Na,l=0):m<0&&(h=Qa,m=0);break;case Na:if(g){if(d.x>=0&&(p>=u||q>=v)){w=!1;break}l+=d.x,m=l/g}else d.x>=0?p<u?l+=d.x:d.y>=0&&q>=v&&(w=!1):l+=d.x,d.y>=0?q<v&&(m+=d.y):m+=d.y;l<0&&m<0?(h=Qa,m=0,l=0):l<0?(h=Oa,l=0):m<0&&(h=Pa,m=0);break;case Ta:e.move(d.x,d.y),w=!1;break;case Ua:e.zoom(function(a,b,c,d){var e=bb(a*a+b*b),f=bb(c*c+d*d);return(f-e)/e}($a(e.startX-e.startX2),$a(e.startY-e.startY2),$a(e.endX-e.endX2),$a(e.endY-e.endY2)),b),e.startX2=e.endX2,e.startY2=e.endY2,w=!1;break;case Sa:if(!d.x||!d.y){w=!1;break}c=B(e.cropper),n=e.startX-c.left,o=e.startY-c.top,l=k.minWidth,m=k.minHeight,d.x>0?h=d.y>0?Na:Pa:d.x<0&&(n-=l,h=d.y>0?Oa:Qa),d.y<0&&(o-=m),e.cropped||(r(e.cropBox,ea),e.cropped=!0,e.limited&&e.limitCropBox(!0,!0))}w&&(k.width=l,k.height=m,k.left=n,k.top=o,e.action=h,e.renderCropBox()),e.startX=e.endX,e.startY=e.endY},crop:function(){var a=this;return a.built&&!a.disabled&&(a.cropped||(a.cropped=!0,a.limitCropBox(!0,!0),a.options.modal&&q(a.dragBox,ca),r(a.cropBox,ea)),a.setCropBoxData(a.initialCropBoxData)),a},reset:function(){var a=this;return a.built&&!a.disabled&&(a.imageData=m({},a.initialImageData),a.canvasData=m({},a.initialCanvasData),a.cropBoxData=m({},a.initialCropBoxData),a.renderCanvas(),a.cropped&&a.renderCropBox()),a},clear:function(){var a=this;return a.cropped&&!a.disabled&&(m(a.cropBoxData,{left:0,top:0,width:0,height:0}),a.cropped=!1,a.renderCropBox(),a.limitCanvas(),a.renderCanvas(),r(a.dragBox,ca),q(a.cropBox,ea)),a},replace:function(a,b){var c=this;return!c.disabled&&a&&(c.isImg&&(c.element.src=a),b?(c.url=a,c.image.src=a,c.built&&(c.image2.src=a,l(c.previews,function(b){D(b,"img")[0].src=a}))):(c.isImg&&(c.replaced=!0),c.options.data=null,c.load(a))),c},enable:function(){var a=this;return a.built&&(a.disabled=!1,r(a.cropper,ia)),a},disable:function(){var a=this;return a.built&&(a.disabled=!0,q(a.cropper,ia)),a},destroy:function(){var a=this,b=a.element,c=a.image;return a.ready?(a.isImg&&a.replaced&&(b.src=a.originalUrl),a.unbuild(),r(b,ea)):a.isImg?x(b,ra,a.start):c&&H(c),v(b,ba),a},move:function(a,b){var c=this,d=c.canvasData;return c.moveTo(e(a)?a:d.left+_(a),e(b)?b:d.top+_(b))},moveTo:function(a,b){var c=this,f=c.canvasData,g=!1;return e(b)&&(b=a),a=_(a),b=_(b),c.built&&!c.disabled&&c.options.movable&&(d(a)&&(f.left=a,g=!0),d(b)&&(f.top=b,g=!0),g&&c.renderCanvas(!0)),c},zoom:function(a,b){var c=this,d=c.canvasData;return a=_(a),a=a<0?1/(1-a):1+a,c.zoomTo(d.width*a/d.naturalWidth,b)},zoomTo:function(a,b){var c,d,e,f,g=this,h=g.options,i=g.canvasData,j=i.width,k=i.height,l=i.naturalWidth,m=i.naturalHeight;if(a=_(a),a>=0&&g.built&&!g.disabled&&h.zoomable){if(c=l*a,d=m*a,y(g.element,ya,{originalEvent:b,oldRatio:j/l,ratio:c/l})===!1)return g;b?(e=B(g.cropper),f=b.touches?C(b.touches):{pageX:b.pageX,pageY:b.pageY},i.left-=(c-j)*((f.pageX-e.left-i.left)/j),i.top-=(d-k)*((f.pageY-e.top-i.top)/k)):(i.left-=(c-j)/2,i.top-=(d-k)/2),i.width=c,i.height=d,g.renderCanvas(!0)}return g},rotate:function(a){var b=this;return b.rotateTo((b.imageData.rotate||0)+_(a))},rotateTo:function(a){var b=this;return a=_(a),d(a)&&b.built&&!b.disabled&&b.options.rotatable&&(b.imageData.rotate=a%360,b.rotated=!0,b.renderCanvas(!0)),b},scale:function(a,b){var c=this,f=c.imageData,g=!1;return e(b)&&(b=a),a=_(a),b=_(b),c.built&&!c.disabled&&c.options.scalable&&(d(a)&&(f.scaleX=a,g=!0),d(b)&&(f.scaleY=b,g=!0),g&&c.renderImage(!0)),c},scaleX:function(a){var b=this,c=b.imageData.scaleY;return b.scale(a,d(c)?c:1)},scaleY:function(a){var b=this,c=b.imageData.scaleX;return b.scale(d(c)?c:1,a)},getData:function(a){var b,c,d=this,e=d.options,f=d.imageData,g=d.canvasData,h=d.cropBoxData;return d.built&&d.cropped?(c={x:h.left-g.left,y:h.top-g.top,width:h.width,height:h.height},b=f.width/f.naturalWidth,l(c,function(d,e){d/=b,c[e]=a?cb(d):d})):c={x:0,y:0,width:0,height:0},e.rotatable&&(c.rotate=f.rotate||0),e.scalable&&(c.scaleX=f.scaleX||1,c.scaleY=f.scaleY||1),c},setData:function(a){var b,c,e,f=this,i=f.options,j=f.imageData,k=f.canvasData,l={};return h(a)&&(a=a.call(f.element)),f.built&&!f.disabled&&g(a)&&(i.rotatable&&d(a.rotate)&&a.rotate!==j.rotate&&(j.rotate=a.rotate,f.rotated=b=!0),i.scalable&&(d(a.scaleX)&&a.scaleX!==j.scaleX&&(j.scaleX=a.scaleX,c=!0),d(a.scaleY)&&a.scaleY!==j.scaleY&&(j.scaleY=a.scaleY,c=!0)),b?f.renderCanvas():c&&f.renderImage(),e=j.width/j.naturalWidth,d(a.x)&&(l.left=a.x*e+k.left),d(a.y)&&(l.top=a.y*e+k.top),d(a.width)&&(l.width=a.width*e),d(a.height)&&(l.height=a.height*e),f.setCropBoxData(l)),f},getContainerData:function(){var a=this;return a.built?a.containerData:{}},getImageData:function(){var a=this;return a.ready?a.imageData:{}},getCanvasData:function(){var a=this,b=a.canvasData,c={};return a.built&&l(["left","top","width","height","naturalWidth","naturalHeight"],function(a){c[a]=b[a]}),c},setCanvasData:function(a){var b=this,c=b.canvasData,e=c.aspectRatio;return h(a)&&(a=a.call(b.element)),b.built&&!b.disabled&&g(a)&&(d(a.left)&&(c.left=a.left),d(a.top)&&(c.top=a.top),d(a.width)?(c.width=a.width,c.height=a.width/e):d(a.height)&&(c.height=a.height,c.width=a.height*e),b.renderCanvas(!0)),b},getCropBoxData:function(){var a,b=this,c=b.cropBoxData;return b.built&&b.cropped&&(a={left:c.left,top:c.top,width:c.width,height:c.height}),a||{}},setCropBoxData:function(a){var b,c,e=this,f=e.cropBoxData,i=e.options.aspectRatio;return h(a)&&(a=a.call(e.element)),e.built&&e.cropped&&!e.disabled&&g(a)&&(d(a.left)&&(f.left=a.left),d(a.top)&&(f.top=a.top),d(a.width)&&(b=!0,f.width=a.width),d(a.height)&&(c=!0,f.height=a.height),i&&(b?f.height=f.width/i:c&&(f.width=f.height*i)),e.renderCropBox()),e},getCroppedCanvas:function(a){var b,c,d,e,f,h,i,j,k,l,m,n=this;if(n.built&&n.cropped&&Wa)return g(a)||(a={}),m=n.getData(),b=m.width,c=m.height,j=b/c,g(a)&&(f=a.width,h=a.height,f?(h=f/j,i=f/b):h&&(f=h*j,i=h/c)),d=db(f||b),e=db(h||c),k=F("canvas"),k.width=d,k.height=e,l=k.getContext("2d"),a.fillColor&&(l.fillStyle=a.fillColor,l.fillRect(0,0,d,e)),l.drawImage.apply(l,function(){var a,d,e,f,g,h,j=O(n.image,n.imageData),k=j.width,l=j.height,o=n.canvasData,p=[j],q=m.x+o.naturalWidth*($a(m.scaleX||1)-1)/2,r=m.y+o.naturalHeight*($a(m.scaleY||1)-1)/2;return q<=-b||q>k?q=a=e=g=0:q<=0?(e=-q,q=0,a=g=Ya(k,b+q)):q<=k&&(e=0,a=g=Ya(b,k-q)),a<=0||r<=-c||r>l?r=d=f=h=0:r<=0?(f=-r,r=0,d=h=Ya(l,c+r)):r<=l&&(f=0,d=h=Ya(c,l-r)),p.push(db(q),db(r),db(a),db(d)),i&&(e*=i,f*=i,g*=i,h*=i),g>0&&h>0&&p.push(db(e),db(f),db(g),db(h)),p}.call(n)),k},setAspectRatio:function(a){var b=this,c=b.options;return b.disabled||e(a)||(c.aspectRatio=Za(0,a)||NaN,b.built&&(b.initCropBox(),b.cropped&&b.renderCropBox())),b},setDragMode:function(a){var b,c,d=this,e=d.options,f=d.dragBox,g=d.face;return d.ready&&!d.disabled&&(b=a===Sa,c=e.movable&&a===Ta,a=b||c?a:Va,u(f,Ia,a),s(f,ha,b),s(f,ga,c),e.cropBoxMovable||(u(g,Ia,a),s(g,ha,b),s(g,ga,c))),d}},T.DEFAULTS={viewMode:0,dragMode:"crop",aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:200,minContainerHeight:100,build:null,built:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},T.TEMPLATE=function(a,b){return b=b.split(","),a.replace(/\d+/g,function(a){return b[a]})}('<0 6="5-container"><0 6="5-wrap-9"><0 6="5-canvas"></0></0><0 6="5-drag-9"></0><0 6="5-crop-9"><1 6="5-view-9"></1><1 6="5-8 8-h"></1><1 6="5-8 8-v"></1><1 6="5-center"></1><1 6="5-face"></1><1 6="5-7 7-e" 3-2="e"></1><1 6="5-7 7-n" 3-2="n"></1><1 6="5-7 7-w" 3-2="w"></1><1 6="5-7 7-s" 3-2="s"></1><1 6="5-4 4-e" 3-2="e"></1><1 6="5-4 4-n" 3-2="n"></1><1 6="5-4 4-w" 3-2="w"></1><1 6="5-4 4-s" 3-2="s"></1><1 6="5-4 4-ne" 3-2="ne"></1><1 6="5-4 4-nw" 3-2="nw"></1><1 6="5-4 4-sw" 3-2="sw"></1><1 6="5-4 4-se" 3-2="se"></1></0></0>',"div,span,action,data,point,cropper,class,line,dashed,box");var kb=a.Cropper;return T.noConflict=function(){return a.Cropper=kb,T},T.setDefaults=function(a){m(T.DEFAULTS,a)},"function"==typeof define&&define.amd&&define("cropper",[],function(){return T}),b||(a.Cropper=T),T});